import{_ as y,i as f,r as p,a as i,q as b,b as t,n as r,d as e,e as n,I as a,F as c,g as x,t as l,h as v}from"./index-DnnHOreL.js";const h={class:"flex items-center mb-6"},M={class:"flex items-center mb-2"},_={class:"pl-4 space-y-1"},w=["href"],C={class:"flex"},P={class:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4"},S={class:"flex items-center mb-2"},k={class:"flex items-center mb-2"},D={class:"flex items-center mb-2"},T={class:"flex items-center mb-2"},B={class:"mb-6"},I={class:"overflow-auto"},j={class:"grid grid-cols-12 gap-1"},q={class:"grid grid-cols-2 gap-1 mt-1"},F={class:"space-y-4"},E={class:"flex"},R={class:"flex"},U={class:"flex"},V={class:"flex"},N={class:"flex"},A={class:"flex"},G={class:"mb-4"},H={class:"p-3 text-sm font-mono overflow-x-auto"},L={class:"mb-4"},W={class:"p-3 text-sm font-mono overflow-x-auto"},z={class:"mb-4"},O={class:"p-3 text-sm font-mono overflow-x-auto"},X={class:"flex"},$={class:"overflow-x-auto mb-6"},J={class:"mb-4"},K={class:"p-3 text-sm font-mono overflow-x-auto"},Q={class:"flex"},Y={class:"mb-4"},Z={class:"p-3 text-sm font-mono overflow-x-auto"},tt={class:"mb-4"},et={class:"p-3 text-sm font-mono overflow-x-auto"},st={class:"mb-4"},rt={class:"p-3 text-sm font-mono overflow-x-auto"},ot={class:"mb-4"},nt={class:"p-3 text-sm font-mono overflow-x-auto"},at={class:"flex"},dt={class:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4"},lt={class:"flex items-center mb-2"},it={class:"flex items-center mb-2"},bt={class:"flex items-center mb-2"},gt={class:"flex items-center mb-2"},ct={class:"flex"},xt={__name:"modbus-scan",setup(ut){const s=f("isDark",p(!1)),u=["Modbus 扫描简介","Modbus 协议基础","扫描原理与流程","代码实现详解","配置参数与选项","高级设置","应用场景与示例","安全建议"],m=[{name:"-m modbus",description:"启用 Modbus 扫描模块",example:"-m modbus"},{name:"-p 502",description:"指定 Modbus 端口（默认为 502）",example:"-p 502,1502"},{name:"-time",description:"设置单个连接超时时间（秒）",example:"-time 5"},{name:"-timeout",description:"设置全局扫描超时时间（秒）",example:"-timeout 300"},{name:"-retries",description:"连接失败时的重试次数",example:"-retries 3"},{name:"-o",description:"将扫描结果输出到指定文件",example:"-o modbus_results.txt"}];return(mt,o)=>(b(),i("div",null,[t("div",h,[t("div",{class:r(["w-10 h-10 flex-shrink-0 rounded-lg mr-3 flex items-center justify-center",e(s)?"bg-orange-900/30":"bg-orange-100"])},[n(e(a),{icon:"mdi:factory",class:r(["text-xl",e(s)?"text-orange-400":"text-orange-600"])},null,8,["class"])],2),t("h1",{class:r(["text-2xl font-bold transition-colors duration-300",e(s)?"text-white":"text-gray-900"])}," Modbus 扫描指南 ",2)]),t("div",{class:r(["mb-6 rounded-lg p-3 transition-colors duration-300",e(s)?"bg-gray-800 border border-gray-700":"bg-gray-50 border border-gray-200"])},[t("div",M,[n(e(a),{icon:"mdi:format-list-bulleted",class:r(["mr-2",e(s)?"text-gray-400":"text-gray-500"])},null,8,["class"]),t("h3",{class:r(["font-medium text-sm transition-colors duration-300",e(s)?"text-gray-200":"text-gray-700"])}," 内容概览 ",2)]),t("ul",_,[(b(),i(c,null,x(u,(d,g)=>t("li",{key:g,class:r(["transition-colors duration-200 text-sm font-normal",e(s)?"text-gray-400 hover:text-orange-400":"text-gray-600 hover:text-orange-600"])},[t("a",{href:`#section-${g}`,class:"hover:underline"},l(d),9,w)],2)),64))])],2),t("div",{class:r(["doc-content transition-colors duration-300",e(s)?"text-gray-300":"text-gray-700"])},[o[6]||(o[6]=t("p",{class:"mb-4"},"Modbus 扫描是 Fscan 的一项工业控制系统安全检测功能，用于发现网络中的 Modbus TCP 设备并检测无认证访问风险。本指南详细介绍 Modbus 扫描的工作原理、配置选项和最佳实践。",-1)),t("h2",{id:"section-0",class:r(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(s)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," Modbus 扫描简介 ",2),o[7]||(o[7]=t("p",{class:"mb-4"},"Modbus 是一种应用于工业控制系统的通信协议，广泛用于可编程逻辑控制器（PLC）、人机界面（HMI）、传感器和各类工业设备之间的通信。Fscan 的 Modbus 扫描模块可以：",-1)),o[8]||(o[8]=t("ul",{class:"pl-5 list-disc space-y-2 mb-6"},[t("li",null,"发现内网中开放的 Modbus TCP 服务（默认端口 502）"),t("li",null,"检测无需认证的 Modbus 设备"),t("li",null,"提取设备基本信息（单元标识符、功能支持情况等）"),t("li",null,"检测线圈状态等设备运行数据")],-1)),t("div",{class:r(["p-3 rounded-lg mb-6 text-sm font-normal",e(s)?"bg-orange-900/10 border border-orange-900/20":"bg-orange-50 border border-orange-100"])},[t("div",C,[n(e(a),{icon:"mdi:shield-alert",class:r(["text-lg flex-shrink-0 mt-0.5 mr-2",e(s)?"text-orange-400":"text-orange-600"])},null,8,["class"]),t("div",null,[t("p",{class:r(["font-medium",e(s)?"text-orange-300":"text-orange-700"])},"安全提示",2),t("p",{class:r(["mt-1",e(s)?"text-orange-200":"text-orange-800"])}," Modbus 协议设计时未考虑安全因素，对工业控制系统进行扫描可能影响设备正常运行。仅在授权的安全测试环境中使用此功能，避免对生产系统造成影响。 ",2)])])],2),t("h2",{id:"section-1",class:r(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(s)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," Modbus 协议基础 ",2),o[9]||(o[9]=t("p",{class:"mb-4"},"Modbus TCP 是基于 TCP/IP 的工业通信协议，在 OSI 模型的应用层实现数据交换：",-1)),t("div",P,[t("div",{class:r(["p-4 rounded-lg border transition-colors duration-300",e(s)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",S,[t("div",{class:r(["w-6 h-6 rounded-md flex items-center justify-center mr-2",e(s)?"bg-blue-900/20":"bg-blue-100"])},[t("span",{class:r(["text-xs font-bold",e(s)?"text-blue-400":"text-blue-600"])},"1",2)],2),t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"数据模型",2)]),t("p",{class:r(["text-sm",e(s)?"text-gray-400":"text-gray-600"])}," 包括线圈（Coils）、离散输入、保持寄存器和输入寄存器四种主要数据类型 ",2)],2),t("div",{class:r(["p-4 rounded-lg border transition-colors duration-300",e(s)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",k,[t("div",{class:r(["w-6 h-6 rounded-md flex items-center justify-center mr-2",e(s)?"bg-blue-900/20":"bg-blue-100"])},[t("span",{class:r(["text-xs font-bold",e(s)?"text-blue-400":"text-blue-600"])},"2",2)],2),t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"功能码",2)]),t("p",{class:r(["text-sm",e(s)?"text-gray-400":"text-gray-600"])}," 定义操作类型，如读取线圈(0x01)、读取寄存器(0x03)、写入单个线圈(0x05)等 ",2)],2),t("div",{class:r(["p-4 rounded-lg border transition-colors duration-300",e(s)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",D,[t("div",{class:r(["w-6 h-6 rounded-md flex items-center justify-center mr-2",e(s)?"bg-blue-900/20":"bg-blue-100"])},[t("span",{class:r(["text-xs font-bold",e(s)?"text-blue-400":"text-blue-600"])},"3",2)],2),t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"MBAP头",2)]),t("p",{class:r(["text-sm",e(s)?"text-gray-400":"text-gray-600"])}," Modbus TCP应用协议头部，包含事务标识符、协议标识符、长度和单元标识符 ",2)],2),t("div",{class:r(["p-4 rounded-lg border transition-colors duration-300",e(s)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",T,[t("div",{class:r(["w-6 h-6 rounded-md flex items-center justify-center mr-2",e(s)?"bg-blue-900/20":"bg-blue-100"])},[t("span",{class:r(["text-xs font-bold",e(s)?"text-blue-400":"text-blue-600"])},"4",2)],2),t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"通信模式",2)]),t("p",{class:r(["text-sm",e(s)?"text-gray-400":"text-gray-600"])}," 客户端-服务器模式，主站（客户端）发送请求，从站（服务器）响应 ",2)],2)]),o[10]||(o[10]=t("p",{class:"mb-4"},"Fscan 的 Modbus 扫描通过发送标准的 Modbus TCP 请求并分析响应来检测设备：",-1)),t("div",B,[t("h3",{class:r(["text-lg font-semibold mb-3 transition-colors duration-300",e(s)?"text-white":"text-gray-800"])}," Modbus TCP帧结构 ",2),t("div",I,[t("div",{class:r(["border rounded-lg transition-colors duration-300 p-2",e(s)?"border-gray-700":"border-gray-200"])},[t("div",j,[t("div",{class:r(["col-span-2 p-2 text-center text-xs rounded",e(s)?"bg-blue-900/20 text-blue-300":"bg-blue-100 text-blue-700"])},o[0]||(o[0]=[t("div",null,"事务标识符",-1),t("div",{class:"font-mono mt-1"},"(2字节)",-1)]),2),t("div",{class:r(["col-span-2 p-2 text-center text-xs rounded",e(s)?"bg-blue-900/20 text-blue-300":"bg-blue-100 text-blue-700"])},o[1]||(o[1]=[t("div",null,"协议标识符",-1),t("div",{class:"font-mono mt-1"},"(2字节)",-1)]),2),t("div",{class:r(["col-span-2 p-2 text-center text-xs rounded",e(s)?"bg-blue-900/20 text-blue-300":"bg-blue-100 text-blue-700"])},o[2]||(o[2]=[t("div",null,"长度",-1),t("div",{class:"font-mono mt-1"},"(2字节)",-1)]),2),t("div",{class:r(["col-span-1 p-2 text-center text-xs rounded",e(s)?"bg-blue-900/20 text-blue-300":"bg-blue-100 text-blue-700"])},o[3]||(o[3]=[t("div",null,"单元标识符",-1),t("div",{class:"font-mono mt-1"},"(1字节)",-1)]),2),t("div",{class:r(["col-span-1 p-2 text-center text-xs rounded",e(s)?"bg-orange-900/20 text-orange-300":"bg-orange-100 text-orange-700"])},o[4]||(o[4]=[t("div",null,"功能码",-1),t("div",{class:"font-mono mt-1"},"(1字节)",-1)]),2),t("div",{class:r(["col-span-4 p-2 text-center text-xs rounded",e(s)?"bg-orange-900/20 text-orange-300":"bg-orange-100 text-orange-700"])},o[5]||(o[5]=[t("div",null,"数据",-1),t("div",{class:"font-mono mt-1"},"(N字节)",-1)]),2)]),t("div",q,[t("div",{class:r(["p-1 text-center text-xs rounded",e(s)?"bg-blue-900/10 text-blue-300":"bg-blue-50 text-blue-600"])}," MBAP 头部 ",2),t("div",{class:r(["p-1 text-center text-xs rounded",e(s)?"bg-orange-900/10 text-orange-300":"bg-orange-50 text-orange-600"])}," PDU (协议数据单元) ",2)])],2)])]),t("h2",{id:"section-2",class:r(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(s)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 扫描原理与流程 ",2),o[11]||(o[11]=t("p",{class:"mb-4"},"Fscan 的 Modbus 扫描通过以下步骤完成设备发现和信息获取：",-1)),t("div",{class:r(["mb-6 p-4 rounded-lg border transition-colors duration-300",e(s)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("ol",F,[t("li",E,[t("div",{class:r(["w-6 h-6 rounded-md flex items-center justify-center mr-3",e(s)?"bg-orange-900/20":"bg-orange-100"])},[t("span",{class:r(["text-xs font-bold",e(s)?"text-orange-400":"text-orange-600"])},"1",2)],2),t("div",null,[t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"端口扫描",2),t("p",{class:r(["text-sm mt-1",e(s)?"text-gray-400":"text-gray-600"])}," 扫描目标IP的Modbus标准端口（默认为502）是否开放 ",2)])]),t("li",R,[t("div",{class:r(["w-6 h-6 rounded-md flex items-center justify-center mr-3",e(s)?"bg-orange-900/20":"bg-orange-100"])},[t("span",{class:r(["text-xs font-bold",e(s)?"text-orange-400":"text-orange-600"])},"2",2)],2),t("div",null,[t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"构建请求",2),t("p",{class:r(["text-sm mt-1",e(s)?"text-gray-400":"text-gray-600"])},' 创建标准的Modbus TCP请求包，包含MBAP头和功能码（默认使用"读取线圈"功能码0x01） ',2)])]),t("li",U,[t("div",{class:r(["w-6 h-6 rounded-md flex items-center justify-center mr-3",e(s)?"bg-orange-900/20":"bg-orange-100"])},[t("span",{class:r(["text-xs font-bold",e(s)?"text-orange-400":"text-orange-600"])},"3",2)],2),t("div",null,[t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"发送与接收",2),t("p",{class:r(["text-sm mt-1",e(s)?"text-gray-400":"text-gray-600"])}," 向目标设备发送Modbus请求，并等待设备响应，支持超时控制和重试机制 ",2)])]),t("li",V,[t("div",{class:r(["w-6 h-6 rounded-md flex items-center justify-center mr-3",e(s)?"bg-orange-900/20":"bg-orange-100"])},[t("span",{class:r(["text-xs font-bold",e(s)?"text-orange-400":"text-orange-600"])},"4",2)],2),t("div",null,[t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"响应验证",2),t("p",{class:r(["text-sm mt-1",e(s)?"text-gray-400":"text-gray-600"])}," 分析响应包，验证是否为有效的Modbus响应，检查协议标识符和功能码 ",2)])]),t("li",N,[t("div",{class:r(["w-6 h-6 rounded-md flex items-center justify-center mr-3",e(s)?"bg-orange-900/20":"bg-orange-100"])},[t("span",{class:r(["text-xs font-bold",e(s)?"text-orange-400":"text-orange-600"])},"5",2)],2),t("div",null,[t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"信息提取",2),t("p",{class:r(["text-sm mt-1",e(s)?"text-gray-400":"text-gray-600"])}," 从Modbus响应中提取设备信息，包括单元标识符、支持的功能以及线圈状态等 ",2)])]),t("li",A,[t("div",{class:r(["w-6 h-6 rounded-md flex items-center justify-center mr-3",e(s)?"bg-orange-900/20":"bg-orange-100"])},[t("span",{class:r(["text-xs font-bold",e(s)?"text-orange-400":"text-orange-600"])},"6",2)],2),t("div",null,[t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"结果记录",2),t("p",{class:r(["text-sm mt-1",e(s)?"text-gray-400":"text-gray-600"])}," 记录扫描结果，包括目标主机、端口、服务类型和提取的设备信息 ",2)])])])],2),t("h2",{id:"section-3",class:r(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(s)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 代码实现详解 ",2),t("h3",{class:r(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(s)?"text-white":"text-gray-800"])}," 构建 Modbus 请求包 ",2),o[12]||(o[12]=t("p",{class:"mb-4"},"Fscan 使用以下代码构建标准的 Modbus TCP 请求包：",-1)),t("div",G,[t("div",{class:r(["rounded-lg overflow-hidden border transition-colors duration-300",e(s)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",H,[t("code",{class:r(["transition-colors duration-300",e(s)?"text-gray-100":"text-gray-800"])},`// buildModbusRequest 构建Modbus TCP请求包
func buildModbusRequest() []byte {
    request := make([]byte, 12)

    // Modbus TCP头部
    binary.BigEndian.PutUint16(request[0:], 0x0001) // 事务标识符
    binary.BigEndian.PutUint16(request[2:], 0x0000) // 协议标识符
    binary.BigEndian.PutUint16(request[4:], 0x0006) // 长度
    request[6] = 0x01                               // 单元标识符

    // Modbus 请求
    request[7] = 0x01                                // 功能码: Read Coils
    binary.BigEndian.PutUint16(request[8:], 0x0000)  // 起始地址
    binary.BigEndian.PutUint16(request[10:], 0x0001) // 读取数量

    return request
}`,2)])],2)]),o[13]||(o[13]=v('<p class="mb-4" data-v-304ddb5b>上述代码创建了一个基本的 Modbus TCP 请求，用于读取设备第一个线圈状态：</p><ul class="pl-5 list-disc space-y-1 mb-6" data-v-304ddb5b><li data-v-304ddb5b>事务标识符 <code data-v-304ddb5b>0x0001</code>：唯一标识请求和对应的响应</li><li data-v-304ddb5b>协议标识符 <code data-v-304ddb5b>0x0000</code>：标准 Modbus 协议</li><li data-v-304ddb5b>长度 <code data-v-304ddb5b>0x0006</code>：后续数据的字节数</li><li data-v-304ddb5b>单元标识符 <code data-v-304ddb5b>0x01</code>：目标设备的地址</li><li data-v-304ddb5b>功能码 <code data-v-304ddb5b>0x01</code>：读取线圈操作</li><li data-v-304ddb5b>起始地址 <code data-v-304ddb5b>0x0000</code>：从地址 0 开始读取</li><li data-v-304ddb5b>读取数量 <code data-v-304ddb5b>0x0001</code>：仅读取 1 个线圈</li></ul>',2)),t("h3",{class:r(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(s)?"text-white":"text-gray-800"])}," 验证 Modbus 响应 ",2),o[14]||(o[14]=t("p",{class:"mb-4"},"接收到响应后，需要验证是否为有效的 Modbus 响应：",-1)),t("div",L,[t("div",{class:r(["rounded-lg overflow-hidden border transition-colors duration-300",e(s)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",W,[t("code",{class:r(["transition-colors duration-300",e(s)?"text-gray-100":"text-gray-800"])},`// isValidModbusResponse 验证Modbus响应是否有效
func isValidModbusResponse(response []byte) bool {
    if len(response) < 9 {
        return false
    }

    // 检查协议标识符
    protocolID := binary.BigEndian.Uint16(response[2:])
    if protocolID != 0 {
        return false
    }

    // 检查功能码
    funcCode := response[7]
    if funcCode == 0x81 { // 错误响应
        return false
    }

    return true
}`,2)])],2)]),t("h3",{class:r(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(s)?"text-white":"text-gray-800"])}," 解析 Modbus 响应 ",2),o[15]||(o[15]=t("p",{class:"mb-4"},"从有效的 Modbus 响应中提取设备信息：",-1)),t("div",z,[t("div",{class:r(["rounded-lg overflow-hidden border transition-colors duration-300",e(s)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",O,[t("code",{class:r(["transition-colors duration-300",e(s)?"text-gray-100":"text-gray-800"])},`// parseModbusResponse 解析Modbus响应获取设备信息
func parseModbusResponse(response []byte) string {
    if len(response) < 9 {
        return ""
    }

    // 提取更多设备信息
    unitID := response[6]
    funcCode := response[7]

    // 简单的设备信息提取，实际应用中可以提取更多信息
    info := fmt.Sprintf("Unit ID: %d, Function: 0x%02X", unitID, funcCode)

    // 如果是读取线圈响应，尝试解析线圈状态
    if funcCode == 0x01 && len(response) >= 10 {
        byteCount := response[8]
        if byteCount > 0 && len(response) >= 9+int(byteCount) {
            coilValue := response[9] & 0x01 // 获取第一个线圈状态
            info += fmt.Sprintf(", Coil Status: %d", coilValue)
        }
    }

    return info
}`,2)])],2)]),t("div",{class:r(["p-3 rounded-lg mb-6 text-sm font-normal",e(s)?"bg-blue-900/10 border border-blue-900/20":"bg-blue-50 border border-blue-100"])},[t("div",X,[n(e(a),{icon:"mdi:information",class:r(["text-lg flex-shrink-0 mt-0.5 mr-2",e(s)?"text-blue-400":"text-blue-600"])},null,8,["class"]),t("div",null,[t("p",{class:r(["font-medium",e(s)?"text-blue-300":"text-blue-700"])},"信息提示",2),t("p",{class:r(["mt-1",e(s)?"text-blue-200":"text-blue-800"])}," Modbus 协议中功能码 0x81 表示请求功能码 0x01 的错误响应。Modbus 错误响应的功能码始终是请求功能码加上 0x80。 ",2)])])],2),t("h2",{id:"section-4",class:r(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(s)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 配置参数与选项 ",2),o[16]||(o[16]=t("p",{class:"mb-4"},"Modbus 扫描提供多种配置选项，以适应不同的扫描需求：",-1)),t("div",$,[t("table",{class:r(["min-w-full rounded-lg overflow-hidden text-sm font-normal",e(s)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("thead",{class:r(e(s)?"bg-gray-850":"bg-gray-50")},[t("tr",null,[t("th",{class:r(["py-3 px-4 text-left font-medium border-b",e(s)?"text-gray-300 border-gray-700":"text-gray-700 border-gray-200"])}," 参数 ",2),t("th",{class:r(["py-3 px-4 text-left font-medium border-b",e(s)?"text-gray-300 border-gray-700":"text-gray-700 border-gray-200"])}," 说明 ",2),t("th",{class:r(["py-3 px-4 text-left font-medium border-b",e(s)?"text-gray-300 border-gray-700":"text-gray-700 border-gray-200"])}," 示例 ",2)])],2),t("tbody",{class:r(["divide-y",e(s)?"divide-gray-700":"divide-gray-200"])},[(b(),i(c,null,x(m,d=>t("tr",{key:d.name,class:r(e(s)?"hover:bg-gray-750":"hover:bg-gray-50")},[t("td",{class:r(["py-2 px-4 font-mono",e(s)?"text-orange-400":"text-orange-600"])},l(d.name),3),t("td",{class:r(["py-2 px-4",e(s)?"text-gray-300":"text-gray-700"])},l(d.description),3),t("td",{class:r(["py-2 px-4 font-mono",e(s)?"text-gray-400":"text-gray-500"])},l(d.example),3)],2)),64))],2)],2)]),t("h2",{id:"section-5",class:r(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(s)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 高级设置 ",2),t("h3",{class:r(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(s)?"text-white":"text-gray-800"])}," 超时和重试机制 ",2),o[17]||(o[17]=t("p",{class:"mb-4"},"Modbus 扫描支持两层超时控制和自动重试：",-1)),t("div",J,[t("div",{class:r(["rounded-lg overflow-hidden border transition-colors duration-300",e(s)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",K,[t("code",{class:r(["transition-colors duration-300",e(s)?"text-gray-100":"text-gray-800"])},`// 设置全局超时上下文
ctx, cancel := context.WithTimeout(context.Background(), time.Duration(Common.GlobalTimeout)*time.Second)
defer cancel()

// 创建单个连接超时的上下文
connCtx, connCancel := context.WithTimeout(ctx, time.Duration(timeoutSeconds)*time.Second)

// 重试机制
for retry := 0; retry < maxRetries; retry++ {
    select {
    case <-ctx.Done():
        return &ModbusScanResult{
            Success: false,
            Error:   fmt.Errorf("全局超时"),
        }
    default:
        if retry > 0 {
            Common.LogDebug(fmt.Sprintf("第%d次重试 Modbus 扫描: %s", retry+1, target))
            time.Sleep(500 * time.Millisecond) // 重试前等待
        }

        // 执行扫描...
    }
}`,2)])],2)]),o[18]||(o[18]=t("p",{class:"mb-4"},"通过这种方式，Fscan 实现了全局超时控制和单个连接超时控制，并在连接失败时提供了自动重试功能。",-1)),t("div",{class:r(["p-3 rounded-lg mb-6 text-sm font-normal",e(s)?"bg-amber-900/10 border border-amber-900/20":"bg-amber-50 border border-amber-100"])},[t("div",Q,[n(e(a),{icon:"mdi:lightbulb",class:r(["text-lg flex-shrink-0 mt-0.5 mr-2",e(s)?"text-amber-400":"text-amber-600"])},null,8,["class"]),t("div",null,[t("p",{class:r(["font-medium",e(s)?"text-amber-300":"text-amber-700"])},"提示",2),t("p",{class:r(["mt-1",e(s)?"text-amber-200":"text-amber-800"])}," 工业网络环境通常响应较慢，建议适当增加超时时间，例如将默认的 3 秒增加到 5-10 秒，以提高扫描的准确性。 ",2)])])],2),t("h3",{class:r(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(s)?"text-white":"text-gray-800"])}," 并发控制 ",2),o[19]||(o[19]=t("p",{class:"mb-4"},"为避免对工业控制系统造成过大负载，Fscan 在 Modbus 扫描中实现了并发控制：",-1)),t("div",Y,[t("div",{class:r(["rounded-lg overflow-hidden border transition-colors duration-300",e(s)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",Z,[t("code",{class:r(["transition-colors duration-300",e(s)?"text-gray-100":"text-gray-800"])},`// 在协程中执行扫描
go func() {
    // 尝试建立连接
    var d net.Dialer
    conn, err := d.DialContext(connCtx, "tcp", target)
    if err != nil {
        select {
        case <-connCtx.Done():
        case resultChan <- &ModbusScanResult{Success: false, Error: err}:
        }
        return
    }
    defer conn.Close()

    // ... 执行扫描逻辑 ...
}()`,2)])],2)]),o[20]||(o[20]=t("p",{class:"mb-4"},"通过 Goroutine 和通道机制，Fscan 能够有效地控制并发扫描任务，同时确保不会因为单个扫描任务阻塞整个扫描过程。",-1)),t("h2",{id:"section-6",class:r(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(s)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 应用场景与示例 ",2),t("h3",{class:r(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(s)?"text-white":"text-gray-800"])}," 扫描单个 Modbus 设备 ",2),t("div",tt,[t("div",{class:r(["rounded-lg overflow-hidden border transition-colors duration-300",e(s)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",et,[t("code",{class:r(["transition-colors duration-300",e(s)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -p 502 -m modbus",2)])],2)]),t("h3",{class:r(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(s)?"text-white":"text-gray-800"])}," 扫描工厂网络 Modbus 设备 ",2),t("div",st,[t("div",{class:r(["rounded-lg overflow-hidden border transition-colors duration-300",e(s)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",rt,[t("code",{class:r(["transition-colors duration-300",e(s)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.0/24 -p 502 -m modbus -time 5 -o modbus_results.txt",2)])],2)]),t("h3",{class:r(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(s)?"text-white":"text-gray-800"])}," 扫描多个端口 ",2),t("div",ot,[t("div",{class:r(["rounded-lg overflow-hidden border transition-colors duration-300",e(s)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",nt,[t("code",{class:r(["transition-colors duration-300",e(s)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -p 502,1502,503 -m modbus -retries 3",2)])],2)]),t("div",{class:r(["p-3 rounded-lg mb-6 text-sm font-normal",e(s)?"bg-green-900/10 border border-green-900/20":"bg-green-50 border border-green-100"])},[t("div",at,[n(e(a),{icon:"mdi:check-circle",class:r(["text-lg flex-shrink-0 mt-0.5 mr-2",e(s)?"text-green-400":"text-green-600"])},null,8,["class"]),t("div",null,[t("p",{class:r(["font-medium",e(s)?"text-green-300":"text-green-700"])},"最佳实践",2),t("p",{class:r(["mt-1",e(s)?"text-green-200":"text-green-800"])}," 对工业控制系统进行扫描时，建议在非生产环境或维护窗口期进行，并使用较低的并发数和较长的超时时间，避免对设备造成负面影响。 ",2)])])],2),t("h2",{id:"section-7",class:r(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(s)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 安全建议 ",2),o[21]||(o[21]=t("p",{class:"mb-4"},"Modbus 协议设计时未考虑安全性，因此在工业环境中使用 Modbus 需要采取额外的安全措施：",-1)),t("div",dt,[t("div",{class:r(["p-4 rounded-lg border transition-colors duration-300",e(s)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",lt,[n(e(a),{icon:"mdi:shield",class:r(["text-lg mr-2",e(s)?"text-orange-400":"text-orange-600"])},null,8,["class"]),t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"网络隔离",2)]),t("p",{class:r(["text-sm",e(s)?"text-gray-400":"text-gray-600"])}," 将工业控制网络与企业网络和互联网物理隔离，使用防火墙严格控制访问 ",2)],2),t("div",{class:r(["p-4 rounded-lg border transition-colors duration-300",e(s)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",it,[n(e(a),{icon:"mdi:shield",class:r(["text-lg mr-2",e(s)?"text-orange-400":"text-orange-600"])},null,8,["class"]),t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"加密隧道",2)]),t("p",{class:r(["text-sm",e(s)?"text-gray-400":"text-gray-600"])}," 使用 VPN 或 SSH 隧道等技术为 Modbus 通信提供加密保护 ",2)],2),t("div",{class:r(["p-4 rounded-lg border transition-colors duration-300",e(s)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",bt,[n(e(a),{icon:"mdi:shield",class:r(["text-lg mr-2",e(s)?"text-orange-400":"text-orange-600"])},null,8,["class"]),t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"访问控制",2)]),t("p",{class:r(["text-sm",e(s)?"text-gray-400":"text-gray-600"])}," 实施基于 IP 和 MAC 地址的访问控制，限制能够与 Modbus 设备通信的主机 ",2)],2),t("div",{class:r(["p-4 rounded-lg border transition-colors duration-300",e(s)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",gt,[n(e(a),{icon:"mdi:shield",class:r(["text-lg mr-2",e(s)?"text-orange-400":"text-orange-600"])},null,8,["class"]),t("h3",{class:r(["font-medium",e(s)?"text-gray-200":"text-gray-800"])},"安全监控",2)]),t("p",{class:r(["text-sm",e(s)?"text-gray-400":"text-gray-600"])}," 部署工业网络监控系统，检测异常的 Modbus 通信和未授权访问尝试 ",2)],2)]),t("div",{class:r(["p-3 rounded-lg mb-6 text-sm font-normal",e(s)?"bg-red-900/10 border border-red-900/20":"bg-red-50 border border-red-100"])},[t("div",ct,[n(e(a),{icon:"mdi:alert",class:r(["text-lg flex-shrink-0 mt-0.5 mr-2",e(s)?"text-red-400":"text-red-600"])},null,8,["class"]),t("div",null,[t("p",{class:r(["font-medium",e(s)?"text-red-300":"text-red-700"])},"风险警告",2),t("p",{class:r(["mt-1",e(s)?"text-red-200":"text-red-800"])}," 未经保护的 Modbus 设备可能被攻击者利用来监控或控制工业流程，甚至可能导致物理设备损坏或安全事故。定期进行安全评估和渗透测试对保障工业系统安全至关重要。 ",2)])])],2)],2),t("div",{class:r(["mt-8 pt-4 border-t transition-colors duration-300 text-sm",e(s)?"border-gray-700":"border-gray-200"])},[t("a",{href:"https://github.com/shadow1ng/fscan/issues",target:"_blank",class:r(["inline-flex items-center transition-colors duration-200",e(s)?"text-orange-400 hover:text-orange-300":"text-orange-600 hover:text-orange-700"])},[n(e(a),{icon:"mdi:github",class:"mr-1.5"}),o[22]||(o[22]=t("span",null,"在 GitHub 上反馈问题",-1))],2)],2)]))}},ft=y(xt,[["__scopeId","data-v-304ddb5b"]]);export{ft as default};
