import{_ as p,i as f,r as h,a as c,q as g,b as t,n as s,d as e,e as l,I as i,F as b,g as x,t as d,f as n}from"./index-DADAu9_P.js";const v={class:"flex items-center mb-6"},w={class:"flex items-center mb-2"},S={class:"pl-4 space-y-1"},_=["href"],H={class:"flex"},k={class:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4"},C={class:"flex items-center mb-2"},P={class:"flex items-center mb-2"},T={class:"flex items-center mb-2"},M={class:"flex items-center mb-2"},B={class:"overflow-x-auto mb-6"},D={class:"mb-4"},F={class:"p-3 text-sm font-mono overflow-x-auto"},N={class:"mb-4"},j={class:"p-3 text-sm font-mono overflow-x-auto"},I={class:"mb-4"},K={class:"p-3 text-sm font-mono overflow-x-auto"},A={class:"mb-4"},E={class:"p-3 text-sm font-mono overflow-x-auto"},G={class:"flex"},V={class:"mb-4"},R={class:"p-3 text-sm font-mono overflow-x-auto"},U={class:"mb-4"},W={class:"p-3 text-sm font-mono overflow-x-auto"},q={class:"mb-4"},z={class:"p-3 text-sm font-mono overflow-x-auto"},L={class:"flex"},$={class:"mb-4"},J={class:"p-3 text-sm font-mono overflow-x-auto"},O={class:"mb-4"},Q={class:"p-3 text-sm font-mono overflow-x-auto"},X={class:"mb-4"},Y={class:"p-3 text-sm font-mono overflow-x-auto"},Z={class:"mb-4"},tt={class:"p-3 text-sm font-mono overflow-x-auto"},et={__name:"ssh-scan",setup(rt){const r=f("isDark",h(!1)),u=["SSH 扫描简介","扫描原理与流程","配置参数与选项","认证方式","高级设置","应用场景与示例"],y=[{name:"-m ssh",description:"启用 SSH 扫描模块",example:"-m ssh"},{name:"-p 22",description:"指定 SSH 端口（默认为 22）",example:"-p 22,2222"},{name:"-user",description:"指定用户名列表，多个用逗号分隔",example:"-user root,admin"},{name:"-pwd",description:"指定密码列表，多个用逗号分隔",example:"-pwd 123456,admin,{user}"},{name:"-key",description:"指定 SSH 私钥文件路径",example:"-key ~/.ssh/id_rsa"},{name:"-t",description:"设置并发线程数",example:"-t 50"},{name:"-time",description:"设置单个连接超时时间（秒）",example:"-time 3"},{name:"-timeout",description:"设置全局扫描超时时间（秒）",example:"-timeout 600"},{name:"-retries",description:"连接失败时的重试次数",example:"-retries 3"}];return(st,o)=>(g(),c("div",null,[t("div",v,[t("div",{class:s(["w-10 h-10 flex-shrink-0 rounded-lg mr-3 flex items-center justify-center",e(r)?"bg-purple-900/30":"bg-purple-100"])},[l(e(i),{icon:"mdi:ssh",class:s(["text-xl",e(r)?"text-purple-400":"text-purple-600"])},null,8,["class"])],2),t("h1",{class:s(["text-2xl font-bold transition-colors duration-300",e(r)?"text-white":"text-gray-900"])}," SSH 扫描指南 ",2)]),t("div",{class:s(["mb-6 rounded-lg p-3 transition-colors duration-300",e(r)?"bg-gray-800 border border-gray-700":"bg-gray-50 border border-gray-200"])},[t("div",w,[l(e(i),{icon:"mdi:format-list-bulleted",class:s(["mr-2",e(r)?"text-gray-400":"text-gray-500"])},null,8,["class"]),t("h3",{class:s(["font-medium text-sm transition-colors duration-300",e(r)?"text-gray-200":"text-gray-700"])}," 内容概览 ",2)]),t("ul",S,[(g(),c(b,null,x(u,(a,m)=>t("li",{key:m,class:s(["transition-colors duration-200 text-sm font-normal",e(r)?"text-gray-400 hover:text-purple-400":"text-gray-600 hover:text-purple-600"])},[t("a",{href:`#section-${m}`,class:"hover:underline"},d(a),9,_)],2)),64))])],2),t("div",{class:s(["doc-content transition-colors duration-300",e(r)?"text-gray-300":"text-gray-700"])},[o[0]||(o[0]=t("p",{class:"mb-4"},"SSH 扫描是 Fscan 的核心功能之一，用于发现网络中的 SSH 服务并尝试进行身份验证。本指南详细介绍 SSH 扫描的工作原理、配置选项和最佳实践。",-1)),t("h2",{id:"section-0",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(r)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," SSH 扫描简介 ",2),o[1]||(o[1]=t("p",{class:"mb-4"},"SSH（Secure Shell）是一种加密网络协议，用于在不安全的网络中安全地操作网络服务。Fscan 的 SSH 扫描模块可以：",-1)),o[2]||(o[2]=t("ul",{class:"pl-5 list-disc space-y-2 mb-6"},[t("li",null,"发现内网中开放的 SSH 服务（默认端口 22）"),t("li",null,"进行身份验证测试（支持密码爆破和密钥认证）"),t("li",null,"识别弱密码和不安全的配置"),t("li",null,"生成详细的扫描报告")],-1)),t("div",{class:s(["p-3 rounded-lg mb-6 text-sm font-normal",e(r)?"bg-purple-900/10 border border-purple-900/20":"bg-purple-50 border border-purple-100"])},[t("div",H,[l(e(i),{icon:"mdi:shield-alert",class:s(["text-lg flex-shrink-0 mt-0.5 mr-2",e(r)?"text-purple-400":"text-purple-600"])},null,8,["class"]),t("div",null,[t("p",{class:s(["font-medium",e(r)?"text-purple-300":"text-purple-700"])},"安全提示",2),t("p",{class:s(["mt-1",e(r)?"text-purple-200":"text-purple-800"])}," SSH 扫描功能应当仅用于合法的安全测试和授权的渗透测试。未经授权对系统进行扫描可能违反法律法规。 ",2)])])],2),t("h2",{id:"section-1",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(r)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 扫描原理与流程 ",2),o[3]||(o[3]=t("p",{class:"mb-4"},"SSH 扫描模块采用多阶段扫描策略，高效识别和测试目标系统：",-1)),t("div",k,[t("div",{class:s(["p-4 rounded-lg border transition-colors duration-300",e(r)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",C,[t("div",{class:s(["w-6 h-6 rounded-md flex items-center justify-center mr-2",e(r)?"bg-green-900/20":"bg-green-100"])},[t("span",{class:s(["text-xs font-bold",e(r)?"text-green-400":"text-green-600"])},"1",2)],2),t("h3",{class:s(["font-medium",e(r)?"text-gray-200":"text-gray-800"])},"服务发现",2)]),t("p",{class:s(["text-sm",e(r)?"text-gray-400":"text-gray-600"])}," 扫描目标 IP 范围，识别开放 SSH 服务（默认或自定义端口）的主机 ",2)],2),t("div",{class:s(["p-4 rounded-lg border transition-colors duration-300",e(r)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",P,[t("div",{class:s(["w-6 h-6 rounded-md flex items-center justify-center mr-2",e(r)?"bg-green-900/20":"bg-green-100"])},[t("span",{class:s(["text-xs font-bold",e(r)?"text-green-400":"text-green-600"])},"2",2)],2),t("h3",{class:s(["font-medium",e(r)?"text-gray-200":"text-gray-800"])},"身份验证选择",2)]),t("p",{class:s(["text-sm",e(r)?"text-gray-400":"text-gray-600"])}," 根据配置决定使用密码爆破或密钥认证方式进行测试 ",2)],2),t("div",{class:s(["p-4 rounded-lg border transition-colors duration-300",e(r)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",T,[t("div",{class:s(["w-6 h-6 rounded-md flex items-center justify-center mr-2",e(r)?"bg-green-900/20":"bg-green-100"])},[t("span",{class:s(["text-xs font-bold",e(r)?"text-green-400":"text-green-600"])},"3",2)],2),t("h3",{class:s(["font-medium",e(r)?"text-gray-200":"text-gray-800"])},"并发验证",2)]),t("p",{class:s(["text-sm",e(r)?"text-gray-400":"text-gray-600"])}," 使用多线程技术同时测试多个凭据组合，支持自动重试和超时控制 ",2)],2),t("div",{class:s(["p-4 rounded-lg border transition-colors duration-300",e(r)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("div",M,[t("div",{class:s(["w-6 h-6 rounded-md flex items-center justify-center mr-2",e(r)?"bg-green-900/20":"bg-green-100"])},[t("span",{class:s(["text-xs font-bold",e(r)?"text-green-400":"text-green-600"])},"4",2)],2),t("h3",{class:s(["font-medium",e(r)?"text-gray-200":"text-gray-800"])},"结果分析",2)]),t("p",{class:s(["text-sm",e(r)?"text-gray-400":"text-gray-600"])}," 记录成功的身份验证并生成详细报告，包括服务版本和认证方式 ",2)],2)]),o[4]||(o[4]=t("p",{class:"mb-4"},"内部实现采用高效的协程池管理，确保即使在大规模扫描时也能保持稳定性和性能。扫描过程中会考虑全局超时和单个连接超时，避免资源浪费。",-1)),t("h2",{id:"section-2",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(r)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 配置参数与选项 ",2),o[5]||(o[5]=t("p",{class:"mb-4"},"SSH 扫描提供多种配置选项，以适应不同的扫描需求：",-1)),t("div",B,[t("table",{class:s(["min-w-full rounded-lg overflow-hidden text-sm font-normal",e(r)?"bg-gray-800 border-gray-700":"bg-white border-gray-200"])},[t("thead",{class:s(e(r)?"bg-gray-850":"bg-gray-50")},[t("tr",null,[t("th",{class:s(["py-3 px-4 text-left font-medium border-b",e(r)?"text-gray-300 border-gray-700":"text-gray-700 border-gray-200"])}," 参数 ",2),t("th",{class:s(["py-3 px-4 text-left font-medium border-b",e(r)?"text-gray-300 border-gray-700":"text-gray-700 border-gray-200"])}," 说明 ",2),t("th",{class:s(["py-3 px-4 text-left font-medium border-b",e(r)?"text-gray-300 border-gray-700":"text-gray-700 border-gray-200"])}," 示例 ",2)])],2),t("tbody",{class:s(["divide-y",e(r)?"divide-gray-700":"divide-gray-200"])},[(g(),c(b,null,x(y,a=>t("tr",{key:a.name,class:s(e(r)?"hover:bg-gray-750":"hover:bg-gray-50")},[t("td",{class:s(["py-2 px-4 font-mono",e(r)?"text-purple-400":"text-purple-600"])},d(a.name),3),t("td",{class:s(["py-2 px-4",e(r)?"text-gray-300":"text-gray-700"])},d(a.description),3),t("td",{class:s(["py-2 px-4 font-mono",e(r)?"text-gray-400":"text-gray-500"])},d(a.example),3)],2)),64))],2)],2)]),t("h2",{id:"section-3",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(r)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 认证方式 ",2),o[6]||(o[6]=t("p",{class:"mb-4"},"SSH 扫描模块支持两种主要的认证方式：",-1)),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(r)?"text-white":"text-gray-800"])}," 密码爆破 ",2),o[7]||(o[7]=t("p",{class:"mb-4"},"当未指定 SSH 密钥路径时，Fscan 默认使用密码爆破方式尝试认证：",-1)),t("div",D,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",e(r)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",F,[t("code",{class:s(["transition-colors duration-300",e(r)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -m ssh -user root -pwd password,123456",2)])],2)]),o[8]||(o[8]=t("p",{class:"mb-4"},[n("密码爆破过程会生成所有用户名和密码的组合，并使用多线程方式并发测试。支持替换变量，如 "),t("code",null,"{user}"),n(" 将被替换为对应的用户名。")],-1)),t("div",N,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",e(r)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",j,[t("code",{class:s(["transition-colors duration-300",e(r)?"text-gray-100":"text-gray-800"])},`// 生成凭据组合
func generateCredentials(users, passwords []string) []SshCredential {
    var credentials []SshCredential
    for _, user := range users {
        for _, pass := range passwords {
            actualPass := strings.Replace(pass, "{user}", user, -1)
            credentials = append(credentials, SshCredential{
                Username: user,
                Password: actualPass,
            })
        }
    }
    return credentials
}`,2)])],2)]),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(r)?"text-white":"text-gray-800"])}," 密钥认证 ",2),o[9]||(o[9]=t("p",{class:"mb-4"},[n("通过指定 "),t("code",null,"-key"),n(" 参数，Fscan 将使用 SSH 密钥进行认证尝试，而非密码爆破：")],-1)),t("div",I,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",e(r)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",K,[t("code",{class:s(["transition-colors duration-300",e(r)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -m ssh -user root -key /path/to/id_rsa",2)])],2)]),o[10]||(o[10]=t("p",{class:"mb-4"},"密钥认证流程如下：",-1)),t("div",A,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",e(r)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",E,[t("code",{class:s(["transition-colors duration-300",e(r)?"text-gray-100":"text-gray-800"])},`// 尝试使用SSH密钥认证
func attemptKeyAuth(info *Common.HostInfo, username, keyPath string, timeoutMs int64) (bool, error) {
    // 读取密钥文件
    pemBytes, err := ioutil.ReadFile(keyPath)
    if err != nil {
        return false, fmt.Errorf("读取密钥失败: %v", err)
    }

    // 解析私钥
    signer, err := ssh.ParsePrivateKey(pemBytes)
    if err != nil {
        return false, fmt.Errorf("解析密钥失败: %v", err)
    }

    // 配置SSH客户端
    config := &ssh.ClientConfig{
        User: username,
        Auth: []ssh.AuthMethod{ssh.PublicKeys(signer)},
        HostKeyCallback: func(hostname string, remote net.Addr, key ssh.PublicKey) error {
            return nil
        },
        Timeout: time.Duration(timeoutMs) * time.Millisecond,
    }

    // 尝试连接
    client, err := ssh.Dial("tcp", fmt.Sprintf("%v:%v", info.Host, info.Ports), config)
    if err != nil {
        return false, err
    }
    defer client.Close()

    // 尝试创建会话
    session, err := client.NewSession()
    if err != nil {
        return false, err
    }
    defer session.Close()

    return true, nil
}`,2)])],2)]),t("div",{class:s(["p-3 rounded-lg mb-6 text-sm font-normal",e(r)?"bg-green-900/10 border border-green-900/20":"bg-green-50 border border-green-100"])},[t("div",G,[l(e(i),{icon:"mdi:check-circle",class:s(["text-lg flex-shrink-0 mt-0.5 mr-2",e(r)?"text-green-400":"text-green-600"])},null,8,["class"]),t("div",null,[t("p",{class:s(["font-medium",e(r)?"text-green-300":"text-green-700"])},"最佳实践",2),t("p",{class:s(["mt-1",e(r)?"text-green-200":"text-green-800"])}," 使用密钥认证比密码爆破更安全、更高效。在可能的情况下，优先使用密钥认证，减少对目标系统的影响。 ",2)])])],2),t("h2",{id:"section-4",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(r)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 高级设置 ",2),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(r)?"text-white":"text-gray-800"])}," 线程控制 ",2),o[11]||(o[11]=t("p",{class:"mb-4"},[n("SSH 扫描模块使用 "),t("code",null,"ModuleThreadNum"),n(" 参数控制并发线程数，可以通过 "),t("code",null,"-t"),n(" 参数设置：")],-1)),t("div",V,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",e(r)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",R,[t("code",{class:s(["transition-colors duration-300",e(r)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.0/24 -m ssh -t 100",2)])],2)]),o[12]||(o[12]=t("p",{class:"mb-4"},"内部实现会自动根据线程数和凭据数量调整工作池大小：",-1)),t("div",U,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",e(r)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",W,[t("code",{class:s(["transition-colors duration-300",e(r)?"text-gray-100":"text-gray-800"])},`// 使用ModuleThreadNum控制并发数
maxConcurrent := Common.ModuleThreadNum
if maxConcurrent <= 0 {
    maxConcurrent = 10 // 默认值
}
if maxConcurrent > len(credentials) {
    maxConcurrent = len(credentials)
}`,2)])],2)]),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(r)?"text-white":"text-gray-800"])}," 超时设置 ",2),o[13]||(o[13]=t("p",{class:"mb-4"},"SSH 扫描支持两层超时控制：",-1)),o[14]||(o[14]=t("ul",{class:"pl-5 list-disc space-y-2 mb-6"},[t("li",null,[t("strong",null,"单个连接超时"),n("：通过 "),t("code",null,"Common.Timeout"),n(" 控制每个 SSH 连接尝试的最大时间")]),t("li",null,[t("strong",null,"全局超时"),n("：通过 "),t("code",null,"Common.GlobalTimeout"),n(" 控制整个扫描任务的最大执行时间")])],-1)),t("div",q,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",e(r)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",z,[t("code",{class:s(["transition-colors duration-300",e(r)?"text-gray-100":"text-gray-800"])},`// 设置全局超时上下文
ctx, cancel := context.WithTimeout(context.Background(),
    time.Duration(Common.GlobalTimeout)*time.Second)
defer cancel()

// 在单个连接中使用超时
connCtx, cancel := context.WithTimeout(context.Background(),
    time.Duration(Common.Timeout)*time.Millisecond)
defer cancel()`,2)])],2)]),t("div",{class:s(["p-3 rounded-lg mb-6 text-sm font-normal",e(r)?"bg-amber-900/10 border border-amber-900/20":"bg-amber-50 border border-amber-100"])},[t("div",L,[l(e(i),{icon:"mdi:lightbulb",class:s(["text-lg flex-shrink-0 mt-0.5 mr-2",e(r)?"text-amber-400":"text-amber-600"])},null,8,["class"]),t("div",null,[t("p",{class:s(["font-medium",e(r)?"text-amber-300":"text-amber-700"])},"提示",2),t("p",{class:s(["mt-1",e(r)?"text-amber-200":"text-amber-800"])}," 在扫描大型网络时，合理设置超时参数非常重要。过短的超时可能导致漏报，而过长的超时会降低扫描效率。建议根据网络环境调整这些参数。 ",2)])])],2),t("h2",{id:"section-5",class:s(["text-xl font-bold mt-8 mb-4 pb-2 border-b transition-colors duration-300",e(r)?"text-white border-gray-700":"text-gray-800 border-gray-200"])}," 应用场景与示例 ",2),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(r)?"text-white":"text-gray-800"])}," 快速扫描整个网段 ",2),t("div",$,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",e(r)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",J,[t("code",{class:s(["transition-colors duration-300",e(r)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.0/24 -p 22 -m ssh",2)])],2)]),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(r)?"text-white":"text-gray-800"])}," 使用自定义用户名和密码 ",2),t("div",O,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",e(r)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",Q,[t("code",{class:s(["transition-colors duration-300",e(r)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -m ssh -user admin,root -pwd admin123,root123,{user}@123",2)])],2)]),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(r)?"text-white":"text-gray-800"])}," 使用密钥文件进行认证 ",2),t("div",X,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",e(r)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",Y,[t("code",{class:s(["transition-colors duration-300",e(r)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.10 -m ssh -user root -key ~/.ssh/id_rsa",2)])],2)]),t("h3",{class:s(["text-lg font-semibold mt-5 mb-3 transition-colors duration-300",e(r)?"text-white":"text-gray-800"])}," 高性能扫描配置 ",2),t("div",Z,[t("div",{class:s(["rounded-lg overflow-hidden border transition-colors duration-300",e(r)?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"])},[t("pre",tt,[t("code",{class:s(["transition-colors duration-300",e(r)?"text-gray-100":"text-gray-800"])},"./fscan -h 192.168.1.0/24 -m ssh -t 200 -time 2 -o ssh_results.txt",2)])],2)]),o[15]||(o[15]=t("p",{class:"mb-4"},"这个配置使用 200 个线程，单个连接超时设置为 2 秒，并将结果保存到文件。",-1))],2),t("div",{class:s(["mt-8 pt-4 border-t transition-colors duration-300 text-sm",e(r)?"border-gray-700":"border-gray-200"])},[t("a",{href:"https://github.com/shadow1ng/fscan/issues",target:"_blank",class:s(["inline-flex items-center transition-colors duration-200",e(r)?"text-purple-400 hover:text-purple-300":"text-purple-600 hover:text-purple-700"])},[l(e(i),{icon:"mdi:github",class:"mr-1.5"}),o[16]||(o[16]=t("span",null,"在 GitHub 上反馈问题",-1))],2)],2)]))}},nt=p(et,[["__scopeId","data-v-43eec0a6"]]);export{nt as default};
